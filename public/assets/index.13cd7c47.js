var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,n=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,s=(e,s)=>{for(var o in s||(s={}))t.call(s,o)&&n(e,o,s[o]);if(a)for(var o of a(s))r.call(s,o)&&n(e,o,s[o]);return e};import{C as o,M as l,a as c,r as i,u as m,R as d,A as u,b as f,c as p,X as g,Y as b,T as h,S as E,d as w,e as y,f as v,Q as x,g as k,h as N,i as _}from"./vendor.932cf61a.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const r=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,s)=>{const o=new URL(e,r);if(self[t].moduleMap[o])return a(self[t].moduleMap[o]);const l=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){s(new Error(`Failed to import: ${e}`)),n(c)},onload(){a(self[t].moduleMap[o]),n(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("/assets/");const O=new o,T=e=>{const t={expires:(e=>{const t=new Date,a=24*e*60*60*1e3;return t.setTime(t.getTime()+a),t})(30),path:"/"};O.set("refresh_token",e,t)},j=()=>O.get("refresh_token"),L=l({id:"auth",initial:"refresh",context:{accessToken:"",refreshToken:""},states:{login:{invoke:{id:"getUser",src:(e,t)=>(async({username:e,password:t})=>{const a=await fetch("https://freddy.codesubmit.io/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),r=await a.json();return T(r.refresh_token),r})(t.data),onDone:{actions:c({accessToken:(e,t)=>t.data.access_token,refreshToken:(e,t)=>t.data.refresh_token})},onError:{target:"logout",actions:{error:(e,t)=>console.log("error",t.data)}}},after:{9e5:"refresh"},on:{LOGOUT:"logout"}},refresh:{after:{9e5:"refresh"},always:[{target:"logout",cond:"isRefreshExpired"}],invoke:{id:"getUser",src:(e,t)=>(async()=>{const e=j();return(await fetch("https://freddy.codesubmit.io/refresh",{method:"POST",headers:{Authorization:`Bearer ${e}`}})).json()})(),onDone:{actions:c({accessToken:(e,t)=>t.data.access_token})},onError:{target:"logout",actions:{error:(e,t)=>console.log("error on refresh",t.data)}}},on:{LOGOUT:"logout"}},logout:{entry:["clearTokens"],on:{LOGIN:"login"}}}},{guards:{isRefreshExpired:(e,t)=>void 0===j()},actions:{clearTokens:c((e=>({accessToken:"",refreshToken:""})))}});const S=({send:e})=>{const[t,a]=i.useState({username:"freddy",password:"ElmStreet2019"}),r=e=>{const{id:t,value:r}=e.target;a((e=>s(s({},e),{[t]:r})))};return i.createElement("div",{className:"flex flex-col"},i.createElement("div",{className:"flex flex-wrap items-center flex-col"},i.createElement("div",{className:"mt-10 w-6/12 sm:w-4/12 px-4"},i.createElement("img",{className:"shadow-lg rounded-full max-w-full h-auto align-middle border-none",src:"/assets/pumpkin.1334a06d.svg",alt:"Pumpkin"})),i.createElement("div",{className:"mt-5 w-6/12 sm:w-6/12 text-2xl text-center font-bold uppercase tracking-widest"},"Welcome to Freddys Halloween candy shop")),i.createElement("form",{className:"m-8",onSubmit:a=>{a.preventDefault(),e({type:"LOGIN",data:t})}},i.createElement("div",{className:"m-8"},i.createElement("div",{className:"flex justify-between items-center"},i.createElement("div",{className:"text-sm font-bold text-gray-700 tracking-wide"},"User Name")),i.createElement("input",{className:"w-full text-lg py-2 border-b border-gray-300 focus:outline-none focus:border-indigo-500",type:"text",placeholder:"freddy",value:t.username,onChange:r})),i.createElement("div",{className:"m-8"},i.createElement("div",{className:"flex justify-between items-center"},i.createElement("div",{className:"text-sm font-bold text-gray-700 tracking-wide"},"Password")),i.createElement("input",{className:"w-full text-lg py-2 border-b border-gray-300 focus:outline-none focus:border-indigo-500",type:"password",placeholder:"Enter your password",value:t.password,onChange:r})),i.createElement("div",{className:"mx-8"},i.createElement("button",{value:"submit",type:"submit",className:"bg-indigo-500 text-gray-100 p-4 w-full rounded-full tracking-wide\n                                font-semibold font-display focus:outline-none focus:shadow-outline hover:bg-indigo-600\n                                shadow-lg"},"Log In"))))},C=({send:e})=>{const[t,a]=((e=!1)=>i.useReducer((e=>!e),e))();return i.createElement("div",{className:"flex justify-between items-center p-3 bg-yellow-500 font-bold uppercase tracking-widest text-white text-center"},i.createElement("div",{className:"font-bold text-lg"},"Halloween candy shop"),i.createElement("div",{className:"ml-3 relative"},i.createElement("div",null,i.createElement("button",{type:"button",className:"bg-gray-800 flex text-sm rounded-full",id:"user-menu",onClick:a,"aria-expanded":"false","aria-haspopup":"true"},i.createElement("span",{className:"sr-only"},"Open user menu"),i.createElement("img",{className:"h-14 w-14 rounded-full",src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:""}))),i.createElement("div",{className:(t?"visible translate-x-0 ease-out transition-medium":"invisible -translate-x-20 ease-in transition-medium")+" transform transition ease-in-out duration-200 origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu"},i.createElement("a",{href:"#",onClick:()=>e("LOGOUT"),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem"},"Sign out"))))},U=({setView:e,view:t})=>i.createElement("div",{className:"flex w-full divide-x border-b-2 justify-center items-baseline flex-wrap"},i.createElement("button",{onClick:()=>e("graph"),className:("graph"===t?"bg-purple-600 text-white":"bg-white text-black")+" w-1/2 p-4 font-bold cursor-pointer"},"Graph"),i.createElement("button",{onClick:()=>e("table"),className:("table"===t?"bg-purple-600 text-white":"bg-white text-black")+" w-1/2 p-4 font-bold cursor-pointer border-l-1"},"Products"));function P(e){return m("dashboard",(()=>(async e=>{const t=await fetch("https://freddy.codesubmit.io/dashboard",{headers:{Authorization:`Bearer ${e}`}}),a=await t.json();return{sales_over_time_week:Object.values(a.dashboard.sales_over_time_week),sales_over_time_year:Object.values(a.dashboard.sales_over_time_year)}})(e)))}const R=({data:e})=>{const[t,a]=i.useState(!0),[r,n]=i.useState([]);function s({active:e,payload:t,label:a}){return e?i.createElement("div",{className:"bg-black text-white shadow-lg rounded p-3 text-center"},i.createElement("h4",null,"Orders ",a," by total ",t[0].value)):null}return i.useEffect((()=>{n(t?e.sales_over_time_week:e.sales_over_time_year)}),[t]),i.createElement("div",{className:"mx-4"},i.createElement("div",{className:"flex items-center my-3",onClick:()=>a(!t)},i.createElement("h2",{className:"mr-5 font-bold text-lg"},t?"sales over week":"sales over year"),i.createElement("div",{className:"w-16 h-10 flex items-center bg-gray-300 rounded-full p-1 duration-300 ease-in-out "+(t?"bg-green-400":"")},i.createElement("div",{className:"bg-white w-8 h-8 rounded-full shadow-md transform duration-300 ease-in-out "+(t?"translate-x-6":"")}))),i.createElement(d,{width:"100%",height:300},i.createElement(u,{data:r},i.createElement("defs",null,i.createElement("linearGradient",{id:"color",x1:"0",y1:"0",x2:"0",y2:"1"},i.createElement("stop",{offset:"0%",stopColor:"#2451B7",stopOpacity:.4}),i.createElement("stop",{offset:"75%",stopColor:"#2451B7",stopOpacity:.05}))),i.createElement(f,{type:"monotone",dataKey:"total",stroke:"#2451B7",fill:"url(#color)"}),i.createElement(p,{opacity:.3,stroke:"#ccc"}),i.createElement(g,{axisLine:!1,tickLine:!1,dataKey:"orders"}),i.createElement(b,{axisLine:!1,tickLine:!1,tickCount:8,dataKey:"total"}),i.createElement(h,{content:i.createElement(s,null)}))))},B=e=>e.reduce(((e,t)=>e+t.total),0),D=({data:e})=>{const t=B(e.sales_over_time_week),a=B(e.sales_over_time_year);return i.createElement("div",{className:"mx-4"},i.createElement("div",{className:"font-bold text-2xl"},"Totals"),i.createElement("div",{className:"flex"},i.createElement("div",{className:"flex flex-col m-2 ml-0 p-4 bg-black text-white rounded"},i.createElement("span",{className:"font-bold text-center"},"week"),i.createElement("span",null,t.toLocaleString())),i.createElement("div",{className:"flex flex-col m-2 p-4 bg-black text-white rounded"},i.createElement("span",{className:"font-bold text-center"},"year"),i.createElement("span",null,a.toLocaleString()))))},$=({accessToken:e})=>{const{isLoading:t,isError:a,data:r}=P(e);return t?i.createElement("div",null,"Loading..."):a?i.createElement("div",null,"Opps somthing get wrong"):i.createElement(i.Fragment,null,i.createElement(D,{data:r}),i.createElement(R,{data:r}))};function M(e,t,a){return m(["orders",t,a],(()=>(async(e,t,a)=>(await fetch(`https://freddy.codesubmit.io/orders?page=${t}&q=${a}`,{headers:{Authorization:`Bearer ${e}`}})).json())(e,t,a)),{keepPreviousData:!0})}const G=({accessToken:e})=>{const[t,a]=i.useState(1),[r,n]=i.useState(""),[s,o]=i.useState(""),[l]=i.useState((()=>new E)),{isLoading:c,isFetching:m,isError:d,data:u}=M(e,t,s),f=(null==u?void 0:u.total)/(null==u?void 0:u.orders.length);i.useEffect((()=>{const e=l.pipe(w(500),y()).subscribe(o);return()=>{e.unsubscribe()}}),[]);return d?i.createElement("div",null,"Opps error..."):i.createElement("div",{className:"relative"},i.createElement("div",{className:"flex items-center justify-center flex-wrap bg-gray-200 p-6"},i.createElement("input",{name:"searchInput",type:"text",value:r,placeholder:"Search...",className:"shadow border border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent border-gray-400 p-2 mr-5 w-2/3 rounded-md",onChange:e=>{n(e.target.value),l.next(e.target.value)}})),i.createElement("div",{className:"overflow-y-auto",style:{height:"calc(100vh - 270px)"}},i.createElement(v.Table,{className:"p-10 overflow-y-auto",keyField:"product.name",isLoading:c,data:null==u?void 0:u.orders,isLoading:m},i.createElement(v.Column,{header:"Product",field:"product.name"}),i.createElement(v.Column,{header:"Image",field:"product.image",component:({value:e})=>i.createElement("img",{src:e,alt:"img"})}),i.createElement(v.Column,{header:"Quantity",field:"product.quantity"}),i.createElement(v.Column,{header:"Date",field:"created_at",component:({value:e})=>{const t=new Date(e).toLocaleDateString("en-US");return i.createElement("div",null,t)}}),i.createElement(v.Column,{header:"Status",cellAlignment:"center",field:"status"}),i.createElement(v.Column,{header:"Total",field:"total"})),i.createElement("div",{className:"absolute flex w-full justify-center items-center"},i.createElement("button",{className:"h-10 ml-3 relative sm:mt-0 sm:h-auto block w-full sm:w-auto border border-transparent px-3 py-2 text-base font-semibold leading-snug bg-gray-900 text-white rounded-md shadow-md hover:bg-gray-800 focus:outline-none focus:bg-gray-800 transition ease-in-out duration-150 hover:bg-gray-600",disabled:1===t,onClick:()=>a(t-1)},"Prev"),i.createElement("div",{className:"h-10 flex justify-center items-center mx-2 w-32"},t," / ",f),i.createElement("button",{className:"h-10 mr-3 relative sm:mt-0 sm:h-auto sm:ml-4 block w-full sm:w-auto border border-transparent px-3 py-2 text-base font-semibold leading-snug bg-gray-900 text-white rounded-md shadow-md hover:bg-gray-800 focus:outline-none focus:bg-gray-800 transition ease-in-out duration-150 hover:bg-gray-600",disabled:t===f,onClick:()=>a(t+1)},"Next"))))},I=new x;function A(){const[e,t]=k(L),[a,r]=i.useState("graph");if(e.matches("logout"))return i.createElement("div",{className:"h-full w-full max-w-2xl m-auto"},i.createElement(S,{send:t}));const{accessToken:n}=e.context;return i.createElement(N,{client:I},i.createElement(C,{send:t}),i.createElement(U,{setView:r,view:a}),"graph"===a?""!==n&&i.createElement($,{accessToken:n}):""!==n&&i.createElement(G,{accessToken:n}))}_.render(i.createElement(i.StrictMode,null,i.createElement(A,null)),document.getElementById("root"));
